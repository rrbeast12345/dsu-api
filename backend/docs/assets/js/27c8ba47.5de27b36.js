"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[871],{4048:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"database/structure","title":"Database Structure","description":"The DSU API system uses Python\'s shelve module for data persistence, providing a simple key-value storage solution. The system is organized into multiple database files, each handling specific aspects of the application.","source":"@site/docs/database/structure.md","sourceDirName":"database","slug":"/database/structure","permalink":"/docs/database/structure","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/database/structure.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"API Endpoints Reference","permalink":"/docs/api/endpoints"},"next":{"title":"Frontend Pages","permalink":"/docs/frontend/pages"}}');var i=s(4848),t=s(8453);const a={sidebar_position:1},l="Database Structure",d={},c=[{value:"Database Overview",id:"database-overview",level:2},{value:"People Database (<code>/people/</code>)",id:"people-database-people",level:2},{value:"Structure",id:"structure",level:3},{value:"Person Object Attributes",id:"person-object-attributes",level:3},{value:"Income Brackets",id:"income-brackets",level:3},{value:"Logins Database (<code>/logins/</code>)",id:"logins-database-logins",level:2},{value:"Structure",id:"structure-1",level:3},{value:"Example",id:"example",level:3},{value:"Grants Database (<code>/grants/</code>)",id:"grants-database-grants",level:2},{value:"Structure",id:"structure-2",level:3},{value:"Grant Application Object",id:"grant-application-object",level:3},{value:"Consents Database (<code>/consents/</code>)",id:"consents-database-consents",level:2},{value:"Structure",id:"structure-3",level:3},{value:"Consent Form Object",id:"consent-form-object",level:3},{value:"Payments Database (<code>/payments/</code>)",id:"payments-database-payments",level:2},{value:"Structure",id:"structure-4",level:3},{value:"Payment Form Object",id:"payment-form-object",level:3},{value:"Uploads Directory (<code>/uploads/</code>)",id:"uploads-directory-uploads",level:2},{value:"Structure",id:"structure-5",level:3},{value:"File Storage",id:"file-storage",level:3},{value:"Data Relationships",id:"data-relationships",level:2},{value:"User to Grants",id:"user-to-grants",level:3},{value:"User to Documents",id:"user-to-documents",level:3},{value:"User to Consents",id:"user-to-consents",level:3},{value:"User to Payments",id:"user-to-payments",level:3},{value:"Database Operations",id:"database-operations",level:2},{value:"Reading Data",id:"reading-data",level:3},{value:"Writing Data",id:"writing-data",level:3},{value:"Deleting Data",id:"deleting-data",level:3},{value:"Backup and Recovery",id:"backup-and-recovery",level:2},{value:"Backup Files",id:"backup-files",level:3},{value:"Recovery Process",id:"recovery-process",level:3},{value:"Performance Considerations",id:"performance-considerations",level:2},{value:"Advantages",id:"advantages",level:3},{value:"Limitations",id:"limitations",level:3},{value:"Best Practices",id:"best-practices",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"database-structure",children:"Database Structure"})}),"\n",(0,i.jsxs)(n.p,{children:["The DSU API system uses Python's ",(0,i.jsx)(n.code,{children:"shelve"})," module for data persistence, providing a simple key-value storage solution. The system is organized into multiple database files, each handling specific aspects of the application."]}),"\n",(0,i.jsx)(n.h2,{id:"database-overview",children:"Database Overview"}),"\n",(0,i.jsxs)(n.p,{children:["The system uses the following shelve databases located in the ",(0,i.jsx)(n.code,{children:"backend/"})," directory:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/people/"})," - User information and profiles"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/logins/"})," - Authentication credentials"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/grants/"})," - Grant applications and status"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/consents/"})," - User consent forms and preferences"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/payments/"})," - Payment form information"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"/uploads/"})," - Document storage (file system)"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"people-database-people",children:["People Database (",(0,i.jsx)(n.code,{children:"/people/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key"}),": ID number (string)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value"}),": Person object"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"person-object-attributes",children:"Person Object Attributes"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class Person:\r\n    def __init__(self, id_number, name, dob):\r\n        self.id_number = id_number          # Unique identifier\r\n        self.name = name                    # Full name\r\n        self.dob = dob                      # Date of birth (YYYY-MM-DD)\r\n        self.verified = False               # Verification status\r\n        self.income_bracket = -1            # Income level (1-5, -1 = not set)\r\n        self.age = get_age(dob)             # Calculated age\r\n        self.citizenship_status = False     # Citizenship status\r\n        self.consents = set()               # Set of granted consents\r\n        self.consent_forms = []             # List of consent form IDs\r\n        self.payment = []                   # Payment information\r\n        self.payment_forms = []             # Payment form IDs\r\n        self.current_grants = []            # List of active grants\r\n        self.identifications = []           # Documents uploaded by user\r\n        self.grant_ids = []                 # IDs for each grant in database\r\n        self.file_ids = []                  # IDs of uploaded files\n"})}),"\n",(0,i.jsx)(n.h3,{id:"income-brackets",children:"Income Brackets"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"1"}),": Lowest income level"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"2"}),": Low income level"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"3"}),": Medium income level"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"4"}),": High income level"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"5"}),": Highest income level"]}),"\n"]}),"\n",(0,i.jsxs)(n.h2,{id:"logins-database-logins",children:["Logins Database (",(0,i.jsx)(n.code,{children:"/logins/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure-1",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key"}),": Username (string)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value"}),": ",(0,i.jsx)(n.code,{children:"[id_number, password]"})]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'{\r\n    "john_doe": ["123456789", "password"],\r\n    "jane_smith": ["987654321", "password"]\r\n}\n'})}),"\n",(0,i.jsxs)(n.h2,{id:"grants-database-grants",children:["Grants Database (",(0,i.jsx)(n.code,{children:"/grants/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure-2",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key"}),": Grant ID (string)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value"}),": Grant application details"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"grant-application-object",children:"Grant Application Object"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"{\r\n    'grant': 'Rent Assistance', \r\n    'submission date': '2025-07-08T08:23:04Z',\r\n    'machine_time': 1751962984.4618962,\r\n    'approved': True|False}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"consents-database-consents",children:["Consents Database (",(0,i.jsx)(n.code,{children:"/consents/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure-3",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key"}),": Form ID (string)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value"}),": Consent information"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"consent-form-object",children:"Consent Form Object"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"{\r\n    'id_number': '65434',\r\n    'consent_given': True,\r\n    'scope': ['See ID'],\r\n    'remove_scope': ['Send photos', 'Use my data to support application'],\r\n    'birthday': '2025-07-08T09:00:38Z'}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"payments-database-payments",children:["Payments Database (",(0,i.jsx)(n.code,{children:"/payments/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure-4",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Key"}),": Form ID (string)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Value"}),": Payment details"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"payment-form-object",children:"Payment Form Object"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"{\r\n    'id_number': '123',\r\n    'wallet_provider': 'amex',\r\n    'wallet_number': '124',\r\n    'birthday': '2025-07-08T08:41:12Z'\r\n}\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"uploads-directory-uploads",children:["Uploads Directory (",(0,i.jsx)(n.code,{children:"/uploads/"}),")"]}),"\n",(0,i.jsx)(n.h3,{id:"structure-5",children:"Structure"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Location"}),": ",(0,i.jsx)(n.code,{children:"backend/uploads/"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Content"}),": Physical files (images, documents)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"File Naming"}),": Generated unique IDs"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Supported Formats"}),": Images (JPG, PNG, etc.)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"file-storage",children:"File Storage"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Example file structure\r\nuploads/\r\n\u251c\u2500\u2500 30.jpg\r\n\u251c\u2500\u2500 31.jpg\r\n\u251c\u2500\u2500 32.jpg\r\n\u2514\u2500\u2500 uploads.pkl  # ID for next file name\n"})}),"\n",(0,i.jsx)(n.h2,{id:"data-relationships",children:"Data Relationships"}),"\n",(0,i.jsx)(n.h3,{id:"user-to-grants",children:"User to Grants"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"One user can have multiple grants"}),"\n",(0,i.jsxs)(n.li,{children:["Relationship maintained through ",(0,i.jsx)(n.code,{children:"grant_ids"})," array in Person object"]}),"\n",(0,i.jsx)(n.li,{children:"Grant details stored separately in grants database"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"user-to-documents",children:"User to Documents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"One user can have multiple documents"}),"\n",(0,i.jsxs)(n.li,{children:["Relationship maintained through ",(0,i.jsx)(n.code,{children:"file_ids"})," array in Person object"]}),"\n",(0,i.jsx)(n.li,{children:"Physical files stored in uploads directory"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"user-to-consents",children:"User to Consents"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"One user can have multiple consent forms"}),"\n",(0,i.jsxs)(n.li,{children:["Relationship maintained through ",(0,i.jsx)(n.code,{children:"consent_forms"})," array in Person object"]}),"\n",(0,i.jsx)(n.li,{children:"Consent details stored separately in consents database"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"user-to-payments",children:"User to Payments"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"One user can have multiple payment methods"}),"\n",(0,i.jsxs)(n.li,{children:["Relationship maintained through ",(0,i.jsx)(n.code,{children:"payment_forms"})," array in Person object"]}),"\n",(0,i.jsx)(n.li,{children:"Payment details stored separately in payments database"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"database-operations",children:"Database Operations"}),"\n",(0,i.jsx)(n.h3,{id:"reading-data",children:"Reading Data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import shelve\r\n\r\n# Open database\r\nwith shelve.open('people/people') as db:\r\n    # Check if key exists\r\n    if 'user_id' in db:\r\n        user = db['user_id']\r\n        print(user.name)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"writing-data",children:"Writing Data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import shelve\r\n\r\n# Open database\r\nwith shelve.open('people/people') as db:\r\n    # Store data\r\n    db['user_id'] = person_object\r\n    \r\n    # Update existing data\r\n    user = db['user_id']\r\n    user.verified = True\r\n    db['user_id'] = user\n"})}),"\n",(0,i.jsx)(n.h3,{id:"deleting-data",children:"Deleting Data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import shelve\r\n\r\n# Open database\r\nwith shelve.open('people/people') as db:\r\n    # Delete key\r\n    if 'user_id' in db:\r\n        del db['user_id']\n"})}),"\n",(0,i.jsx)(n.h2,{id:"backup-and-recovery",children:"Backup and Recovery"}),"\n",(0,i.jsx)(n.h3,{id:"backup-files",children:"Backup Files"}),"\n",(0,i.jsx)(n.p,{children:"Each shelve database creates backup files:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:".bak"})," - Backup file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:".dat"})," - Data file"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:".dir"})," - Directory file"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"recovery-process",children:"Recovery Process"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Stop the application"}),"\n",(0,i.jsx)(n.li,{children:"Copy backup files to restore directory"}),"\n",(0,i.jsx)(n.li,{children:"Restart the application"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"performance-considerations",children:"Performance Considerations"}),"\n",(0,i.jsx)(n.h3,{id:"advantages",children:"Advantages"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Simple setup and maintenance"}),"\n",(0,i.jsx)(n.li,{children:"No external database server required"}),"\n",(0,i.jsx)(n.li,{children:"Automatic serialization of Python objects"}),"\n",(0,i.jsx)(n.li,{children:"Built-in backup mechanism"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"limitations",children:"Limitations"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Single-threaded access (no concurrent writes)"}),"\n",(0,i.jsx)(n.li,{children:"Limited query capabilities"}),"\n",(0,i.jsx)(n.li,{children:"File size grows with data"}),"\n",(0,i.jsx)(n.li,{children:"No built-in indexing"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use separate databases for different data types"}),"\n",(0,i.jsx)(n.li,{children:"Implement proper error handling"}),"\n",(0,i.jsx)(n.li,{children:"Regular backup procedures"}),"\n",(0,i.jsx)(n.li,{children:"Monitor file sizes"}),"\n",(0,i.jsx)(n.li,{children:"Consider migration to SQLite for larger datasets"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var r=s(6540);const i={},t=r.createContext(i);function a(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);